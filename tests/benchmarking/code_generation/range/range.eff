effect Fetch : unit -> int;;
external ( - ) : int -> int -> int = "-";;

type int_list = Nil | Cons of int * int_list
;;
let test n = 
	let rec range n =
		match n with
		| 0 -> Nil
		| _ ->
			let n1 = n - 1 
			in Cons (perform (Fetch ()), range (n1))
	in			
	handle ( range n ) with
	| x -> x
	| effect (Fetch _) k -> k 42
