effect Decide : unit -> bool

;;

let rec (@) xs ys =
  match xs with
  | [] -> ys
  | x :: xs -> x :: (xs @ ys)
in

let choose_all = handler
  | effect (Decide ()) k -> k true @ k false
  | x -> [x]
in

let decide_func1 x y =
    (if perform (Decide ()) then x else y) in
with choose_all handle (decide_func1 10 20 )
